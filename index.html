<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Arduino Projects</title>

<!-- âœ… Google Site Verification -->
<meta name="google-site-verification" content="k6c9g_1RBvchIdYEEi6oBwIAzo4H20m8k-IA4qQ1Hsg" />

<!-- âœ… Google AdSense verification -->
<meta name="google-adsense-account" content="ca-pub-9682075855356738" />
<script async src="https://pagead2.googlesyndication.com/pagead/js?client=ca-pub-9682075855356738"
     crossorigin="anonymous"></script>

<!-- âœ… AMP Auto Ads Library -->
<script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>

<!-- âœ… Open Graph Meta Tags -->
<meta property="og:title" content="Arduino Projects" />
<meta property="og:description" content="Ø´ÙˆÙÙˆØ§ Ù…Ø´Ø±ÙˆØ¹ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø¹Ù„Ù‰ Ø£Ø±Ø¯ÙˆÙŠÙ†Ùˆ!" />
<meta property="og:image" content="https://tdhouaya-ui.github.io/Talel.png" />
<meta property="og:image:alt" content="Arduino Projects Logo" />
<meta property="og:url" content="https://tdhouaya-ui.github.io/project000/" />
<meta property="og:type" content="website" />

<style>
body { font-family: Arial, sans-serif; text-align: center; margin: 20px; }
h1 { color: #0277bd; }
.new-project { margin-bottom: 30px; }
.new-project input, .new-project textarea { width: 80%; padding: 8px; margin: 5px 0; }
.new-project button { background: #0277bd; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 16px; }
.new-project button:hover { background: #01579b; }
.project { border: 1px solid #ccc; padding: 10px; margin: 10px auto; width: 90%; border-radius: 8px; text-align: left; }
.stats { margin-top: 5px; }
.icons span { margin-right: 15px; cursor: pointer; }
pre { background: #f4f4f4; padding: 10px; border-radius: 5px; overflow-x: auto; }
.copy-btn { background: #4caf50; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; float: right; }
.copy-btn:hover { background: #388e3c; }
</style>

<!-- Google Analytics & Consent Mode -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KW6FFEKB21"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-KW6FFEKB21');

// Ø¥Ø¹Ø¯Ø§Ø¯ Consent Mode
gtag('consent', 'default', {
  'ad_storage': 'denied',
  'analytics_storage': 'denied'
});
</script>
</head>
<body>

<!-- âœ… AMP Auto Ads Placement -->
<amp-auto-ads type="adsense"
        data-ad-client="ca-pub-9682075855356738">
</amp-auto-ads>

<div style="text-align:center; margin-bottom:20px;">
  <img src="Talel.png" alt="Arduino Projects Logo" width="200" height="200">
</div>

<h1>ğŸ’¡ Arduino Projects with Code ğŸ’¡</h1>

<!-- ğŸŸ¢ Ø¥Ø¹Ù„Ø§Ù† Ø¹Ø±Ø¶ÙŠ -->
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-client="ca-pub-9026863351080278"
     data-ad-slot="8713698185"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<button onclick="showAddProject()">Add New Project (Owner Only)</button>

<div class="new-project" id="addProjectDiv" style="display:none;">
  <h3>Add Your Own Arduino Project ğŸ§ </h3>
  <input type="text" id="newTitle" placeholder="Project Title">
  <textarea id="newCode" rows="6" placeholder="Paste your Arduino code here"></textarea>
  <button onclick="addProject()">Add Project</button>
</div>

<div id="projectsContainer"></div>

<!-- âœ… CMP Consent Banner -->
<script>
function showConsentBanner() {
  const banner = document.createElement('div');
  banner.id = 'consent-banner';
  banner.style.position = 'fixed';
  banner.style.bottom = '0';
  banner.style.left = '0';
  banner.style.right = '0';
  banner.style.background = '#0277bd';
  banner.style.color = '#fff';
  banner.style.padding = '15px';
  banner.style.textAlign = 'center';
  banner.style.zIndex = '9999';
  banner.style.fontSize = '16px';
  banner.innerHTML = `
    ğŸŒ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„ÙƒÙˆÙƒÙŠØ² ÙˆØ§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª. <br><br>
    <button onclick="acceptConsent()" style="margin:5px;padding:5px 12px;background:#4caf50;color:white;border:none;border-radius:5px;cursor:pointer;">Ù…ÙˆØ§ÙÙ‚Ø© âœ…</button>
    <button onclick="rejectConsent()" style="margin:5px;padding:5px 12px;background:#f44336;color:white;border:none;border-radius:5px;cursor:pointer;">Ø±ÙØ¶ âŒ</button>
    <button onclick="manageConsent()" style="margin:5px;padding:5px 12px;background:#ffc107;color:white;border:none;border-radius:5px;cursor:pointer;">Ø¥Ø¯Ø§Ø±Ø© âš™ï¸</button>
  `;
  document.body.appendChild(banner);
}

function acceptConsent() {
  gtag('consent', 'update', {
    'ad_storage': 'granted',
    'analytics_storage': 'granted'
  });
  document.getElementById('consent-banner').remove();
}

function rejectConsent() {
  gtag('consent', 'update', {
    'ad_storage': 'denied',
    'analytics_storage': 'denied'
  });
  document.getElementById('consent-banner').remove();
}

function manageConsent() {
  alert('Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ø®ÙŠØ§Ø±Ø§Øª Ø£ÙƒØ«Ø± Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒÙˆÙƒÙŠØ² ÙˆØ§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª.');
}

window.addEventListener('load', showConsentBanner);
</script>

<!-- Firebase + Projects Code -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getDatabase, ref, set, update, increment, get } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "REMOVE_ME_REPLACE_WITH_ENV",
  authDomain: "arduino-projects-with-code.firebaseapp.com",
  databaseURL: "https://arduino-projects-with-code-default-rtdb.europe-west1.firebasedatabase.app/",
  projectId: "arduino-projects-with-code",
  storageBucket: "arduino-projects-with-code.firebasestorage.app",
  messagingSenderId: "270851114359",
  appId: "1:270851114359:web:864c43de6789b6b0c8d72",
  measurementId: "G-KW6FFEKB21"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const OWNER_PASSWORD = "talel123";

let visitorID = localStorage.getItem("visitorID");
if (!visitorID) {
  visitorID = crypto.randomUUID();
  localStorage.setItem("visitorID", visitorID);
}

let projects = [];
const container = document.getElementById("projectsContainer");

async function loadProjectsFromFirebase() {
  const dbRef = ref(db, "projects/");
  const snapshot = await get(dbRef);
  projects = [];

  if (snapshot.exists()) {
    const data = snapshot.val();
    for (const id in data) {
      const p = data[id];
      if (p && p.title && p.code) {
        projects.push({ id, title: p.title, code: p.code });
      }
    }
  }
  renderProjects();
}

async function renderProjects() {
  container.innerHTML = "";

  if (projects.length === 0) {
    container.innerHTML = "<p>No projects yet.</p>";
    return;
  }

  for (let i = 0; i < projects.length; i++) {
    const p = projects[i];
    const div = document.createElement("div");
    div.className = "project";
    div.innerHTML = `
      <button class="toggle" onclick="toggleCode(${i})">â¬‡ï¸</button>
      <h3>${p.title}</h3>
      <div class="stats">
        <div class="icons">
          <span id="views-${p.id}">ğŸ‘ï¸ 0 views</span>
          <span id="likes-${p.id}" onclick="likeProject('${p.id}')">â¤ï¸ 0</span>
        </div>
      </div>
      <pre id="code-${i}" style="display:none;">
        <button class="copy-btn" onclick="copyCode('${p.id}')">ğŸ“‹ Copy</button>
        <code>${p.code}</code>
      </pre>
    `;
    container.appendChild(div);

    const projectRef = ref(db, "projects/" + p.id);
    const snapshot = await get(projectRef);
    if (snapshot.exists()) {
      const data = snapshot.val();
      document.getElementById("views-" + p.id).innerText = `ğŸ‘ï¸ ${data.views || 0} views`;
      document.getElementById("likes-" + p.id).innerText = `â¤ï¸ ${data.likes || 0}`;
    }

    const visitorRef = ref(db, `projects/${p.id}/visitors/${visitorID}`);
    const visitorSnap = await get(visitorRef);
    if (!visitorSnap.exists()) {
      update(projectRef, { views: increment(1) });
      await set(visitorRef, true);
    }
  }
}

window.showAddProject = function() {
  const enteredPass = prompt("Enter password:");
  if (enteredPass === OWNER_PASSWORD) {
    document.getElementById("addProjectDiv").style.display = "block";
  } else alert("âŒ Access denied!");
};

window.addProject = async function() {
  const title = document.getElementById("newTitle").value.trim();
  const code = document.getElementById("newCode").value.trim();
  if (!title || !code) return alert("âš ï¸ Enter title and code!");

  const id = title.toLowerCase().replace(/[^a-z0-9]+/g, "-").replace(/^-+|-+$/g, "");

  try {
    await set(ref(db, "projects/" + id), {
      title,
      code,
      views: 0,
      likes: 0,
    });

    alert("âœ… Project added successfully!");
    document.getElementById("newTitle").value = "";
    document.getElementById("newCode").value = "";
    loadProjectsFromFirebase();
  } catch (err) {
    console.error(err);
    alert("âŒ Failed to add project.");
  }
};

window.likeProject = async function(id) {
  update(ref(db, "projects/" + id), { likes: increment(1) });
};

window.copyCode = function(id) {
  const project = projects.find(p => p.id === id);
  if (project) {
    navigator.clipboard.writeText(project.code);
    alert("âœ… Code copied!");
  }  
};

window.toggleCode = function(i) {
  const codeBlock = document.getElementById(`code-${i}`);
  codeBlock.style.display = codeBlock.style.display === "block" ? "none" : "block";
};

loadProjectsFromFirebase();
</script>

</body>
</html>
